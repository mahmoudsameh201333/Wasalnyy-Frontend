<app-header-bar></app-header-bar>
<div class="container">
  <div class="header">
    <h1> Reports & Analytics</h1>
    </div>

  <!-- Message -->
  <div *ngIf="message" [ngClass]="messageType === 'success' ? 'success' : 'error'">
    {{ message }}
  </div>

  <!-- Loading State -->
  <div *ngIf="isLoading" class="loading">
    Loading reports...
  </div>

  <!-- Dashboard Stats -->
  <div class="stats-container" *ngIf="dashboardLoaded && !isLoading">
    <div class="stat-card drivers-card">
      <div class="stat-icon"></div>
      <div class="stat-content">
        <h3>Total Drivers</h3>
        <p class="stat-number">{{ totalDrivers }}</p>
      </div>
    </div>

    <div class="stat-card riders-card">
      <div class="stat-icon"></div>
      <div class="stat-content">
        <h3>Total Riders</h3>
        <p class="stat-number">{{ totalRiders }}</p>
      </div>
    </div>

    <div class="stat-card trips-card">
      <div class="stat-icon"></div>
      <div class="stat-content">
        <h3>Total Trips</h3>
        <p class="stat-number">{{ totalTrips }}</p>
      </div>
    </div>
  </div>

  <!-- Search Section -->
  <div class="search-section" *ngIf="dashboardLoaded">
    <h3>Search Complaints</h3>
    <div class="search-group">
      <input 
        type="text" 
        [(ngModel)]="complaintId" 
        placeholder="Enter complaint ID (UUID)"
      >
      <button (click)="getComplaintById()">Search Complaint</button>
    </div>
  </div>

  <!-- Action Buttons -->
  <div class="buttons-section" *ngIf="dashboardLoaded">
    <button class="action-btn btn-refresh" (click)="refreshDashboard()">
       Refresh Dashboard
    </button>
    <button class="action-btn btn-export" (click)="exportData()">
       Export Report
    </button>
    <button class="action-btn btn-search" (click)="getComplaintById()" [disabled]="!complaintId">
       Search Complaint
    </button>
  </div>

  <!-- Complaints Results -->
  <div class="results-section" *ngIf="complaints.length > 0">
    <h3>Complaint Details</h3>
    
    <table>
      <thead>
        <tr>
          <th>Complaint ID</th>
          <th>Title</th>
          <th>Description</th>
          <th>Reported By</th>
          <th>Created At</th>
          <th>Status</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let complaint of complaints">
          <td>{{ complaint.id }}</td>
          <td>{{ complaint.title || 'N/A' }}</td>
          <td>{{ complaint.description || 'N/A' }}</td>
          <td>{{ complaint.reportedBy?.fullName || 'N/A' }}</td>
          <td>{{ complaint.createdAt | date:'medium' }}</td>
          <td>
            <span [ngClass]="'status-' + (complaint.status | lowercase)">
              {{ complaint.status || 'Pending' }}
            </span>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Summary Section -->
  <div class="summary-section" *ngIf="dashboardLoaded && !isLoading">
    <h3>Platform Summary</h3>
    <div class="summary-grid">
      <div class="summary-item">
        <span class="label">Active Drivers:</span>
        <span class="value">{{ totalDrivers }}</span>
      </div>
      <div class="summary-item">
        <span class="label">Active Riders:</span>
        <span class="value">{{ totalRiders }}</span>
      </div>
      <div class="summary-item">
        <span class="label">Total Trips:</span>
        <span class="value">{{ totalTrips }}</span>
      </div>
      <div class="summary-item">
        <span class="label">Last Updated:</span>
        <span class="value">{{ 'now' | date:'short' }}</span>
      </div>
    </div>
  </div>
</div>